<div class="container py-4">
  <h1 class="text-center text-primary mb-4">Gestor de Plantillas PDF</h1>

  <!-- Cargar PDF -->
  <div class="row mb-4">
    <div class="col-md-6">
      <label for="pdfInput" class="form-label fw-bold">Seleccionar archivo PDF:</label>
      <input
        type="file"
        id="pdfInput"
        accept="application/pdf"
        (change)="onFileSelected($event)"
        class="form-control"
      />
    </div>
    <div class="col-md-6 d-flex align-items-end">
      <button
        class="btn btn-primary w-100 fw-bold"
        [disabled]="!pdfUrl"
        (click)="addToFavorites()"
      >
        Añadir a favoritos
      </button>
    </div>
  </div>

  <!-- Vista PDF con capa interactiva -->
  <div class="row mb-4">
    <div class="col-md-12 position-relative" style="height: 500px; overflow-y: scroll;">
      <canvas #pdfCanvas class="w-100 h-100 border rounded"></canvas>
      <div
        class="overlay"
        (click)="onPdfClick($event)"
        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: auto; cursor: crosshair;"
      ></div>
    </div>
  </div>

  <!-- Botones de navegación -->
  <div class="row mb-4">
    <div class="col-md-12 d-flex justify-content-between">
      <button class="btn btn-secondary" (click)="prevPage()" [disabled]="currentPage <= 1">
        Anterior
      </button>
      <span>Página {{ currentPage }} de {{ totalPages }}</span>
      <button class="btn btn-secondary" (click)="nextPage()" [disabled]="currentPage >= totalPages">
        Siguiente
      </button>
    </div>
  </div>

  <!-- Descargar con Anotaciones -->
  <div class="row mb-4">
    <div class="col-md-12">
      <button class="btn btn-success" (click)="downloadPdfWithAnnotations()">
        Descargar PDF con Anotaciones
      </button>
    </div>
  </div>

  <!-- Favoritos -->
  <div class="row">
    <div class="col-md-12">
      <h3 class="text-secondary">Favoritos</h3>
      <div *ngIf="favorites.length > 0" style="max-height: 200px; overflow-y: auto;">
        <ul class="list-group">
          <li
            *ngFor="let favorite of favorites"
            class="list-group-item d-flex justify-content-between align-items-center"
          >
            <span class="fw-bold text-truncate">{{ favorite.name }}</span>
            <div class="btn-group">
              <button
                class="btn btn-sm btn-primary"
                (click)="downloadFavorite(favorite)"
              >
                Descargar Original
              </button>
              <button
                class="btn btn-sm btn-success"
                (click)="openFavorite(favorite)"
              >
                Abrir
              </button>
              <button
                class="btn btn-sm btn-danger"
                (click)="removeFavorite(favorite)"
              >
                Eliminar
              </button>
            </div>
          </li>
        </ul>
      </div>
      <div *ngIf="favorites.length === 0" class="alert alert-info">
        Aún no tienes archivos favoritos.
      </div>
    </div>
  </div>
</div>
